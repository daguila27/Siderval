<%
function trunc (x, posiciones = 0) {
	  	var s = x.toString()
	  	var l = s.length
	  	if(s.indexOf('.') == -1){
	  		return x;
	  	}
	  	else{
			var decimalLength = s.indexOf('.') + 1;
	  		var numStr = s.substr(0, decimalLength + posiciones);
	  		return Number(numStr);
	  	}
	  	
	}


function numberFormat(numero){
        var resultado = "";
        if(numero[0]=="-")
        {
            nuevoNumero=numero.replace(/\./g,'').substring(1);
        }else{
            nuevoNumero=numero.replace(/\./g,'');
        }
        if(numero.indexOf(",")>=0)
            nuevoNumero=nuevoNumero.substring(0,nuevoNumero.indexOf(","));
 
        for (var j, i = nuevoNumero.length - 1, j = 0; i >= 0; i--, j++)
            resultado = nuevoNumero.charAt(i) + ((j > 0) && (j % 3 == 0)? ".": "") + resultado;
        if(numero.indexOf(",")>=0)
            resultado+=numero.substring(numero.indexOf(","));
        if(numero[0]=="-")
        {
            return "-"+resultado;
        }else{
            return resultado;
        }
    }
%>
<div class="ventana" style="margin: 0; padding: 0; overflow: hidden;">
<%if(semi[0].d_token){%>
	<h3 style="margin-bottom: 35px; margin-left: 5%;"><%= semi[0].detalle.substring(0,1).toUpperCase() + semi[0].detalle.substring(1,semi[0].detalle.length).toLowerCase()%> <small><%=semi[0].codigo%></small></h3>
	<table class="table table-striped table-hover">
		<thead>
                    <tr>
                        <th>Descripcion</th>
                        <th>Cantidad</th>
                        <th>Costo</th>
                        <th>Stock</th>
						<th>Stock Aviso</th>
						<th>Stock Cr√≠tico</th>
                    </tr>
                    </thead>
                    <tbody>
					<%
					var clase;
					if(semi.length){
						semi[0].d_token = semi[0].d_token.split('@');
						semi[0].c_token = semi[0].c_token.split('@');
						semi[0].s_token = semi[0].s_token.split('@');
						semi[0].sc_token = semi[0].sc_token.split('@');
						semi[0].si_token = semi[0].si_token.split('@');
						semi[0].p_token = semi[0].p_token.split('@');
						semi[0].u_token = semi[0].u_token.split('@');
						for(var n=0; n < semi[0].d_token.length; n++){
							if(parseInt(semi[0].s_token[n]) <= parseInt(semi[0].sc_token[n])){
								clase = 'danger';
							}
							else if(parseInt(semi[0].s_token[n]) <= parseInt(semi[0].si_token[n])){
								clase = 'warning';
							} else {
							    clase = 'success';
							}
						%>
						<tr class="<%= clase%>">
								<td><%=semi[0].d_token[n].substring(0,1).toUpperCase() + semi[0].d_token[n].substring(1,semi[0].d_token[n].length).toLowerCase()%></td>
								<td><%= trunc(semi[0].c_token[n], 2)%> <%= semi[0].u_token[n]%></td>
								<td>$<%= numberFormat(semi[0].p_token[n])%></td>
								<td><%= numberFormat(semi[0].s_token[n])%></td>
								<%if(semi[0].si_token[n] == '0'){%>
									<td>-</td>
									<td>-</td>
								<%}else{%>
									<td><%= numberFormat(semi[0].si_token[n])%></td>
									<td><%= semi[0].sc_token[n].toLocaleString()%></td>
								<%}%>
						</tr>

					<%}}%>
				</tbody>
	</table>



<%}else{%>
	<h2 style="text-align: center;">No existe B.O.M.</h2>
<%}%>
</div>

<script type="text/javascript">
	$(document).ready(function(){
		if(parseInt($(".ventana").css('height').substring(0,$(".ventana").css('height').length-2 ) )> screen.height*(0.61) ){
				$(".ventana").css('height', screen.height*(0.61));
				$(".ventana").css('overflow-y','scroll');

		}
	});
</script>
